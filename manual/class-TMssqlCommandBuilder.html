<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="generator" content=" ">
	<meta charset="utf-8">

	<meta http-equiv="content-language" content="en">
	<meta name="Keywords" content="PRADO PHP framework component template event property OOP PHP5 object oriented programming Web programming development">
	<meta name="Description" content="PRADO is a component-based and event-driven framework for Web application development in PHP 5.">
	<meta name="Author" content="Qiang Xue">
	<meta name="Subject" content="Web programming, PHP framework">
	<meta name="Language" content="en">
	<link rel="Shortcut Icon" href="/favicon.ico">
	<link rel="stylesheet" type="text/css" href="/css/style.css">
	<link rel="stylesheet" type="text/css" href="/css/manual.css">

	<title>Class TMssqlCommandBuilder | PRADO v3.3.1 API Manual</title>

	<link rel="stylesheet" href="resources/style.css?156e1f7b7b33338aff331811a5808582bb99d288">

</head>

<body>

<div id="left">
	<div id="menu">
		<a href="index.html" title="Overview"><span>Overview</span></a>


		<div id="groups">
				<h3>Packages</h3>
			<ul>
				<li>
					<a href="package-System.html">
						System<span></span>
					</a>

						<ul>
				<li>
					<a href="package-System.Caching.html">
						Caching					</a>

						</li>
				<li>
					<a href="package-System.Collections.html">
						Collections					</a>

						</li>
				<li>
					<a href="package-System.Data.html">
						Data<span></span>
					</a>

						<ul>
				<li>
					<a href="package-System.Data.ActiveRecord.html">
						ActiveRecord<span></span>
					</a>

						<ul>
				<li>
					<a href="package-System.Data.ActiveRecord.Relations.html">
						Relations					</a>

						</li>
				<li>
					<a href="package-System.Data.ActiveRecord.Scaffold.html">
						Scaffold<span></span>
					</a>

						<ul>
				<li>
					<a href="package-System.Data.ActiveRecord.Scaffold.InputBuilder.html">
						InputBuilder					</a>

						</li>
							</ul></li></ul></li>
				<li>
					<a href="package-System.Data.Commom.html">
						Commom<span></span>
					</a>

						<ul>
				<li>
					<a href="package-System.Data.Commom.Sqlite.html">
						Sqlite					</a>

						</li>
							</ul></li>
				<li>
					<a href="package-System.Data.Common.html">
						Common<span></span>
					</a>

						<ul>
				<li>
					<a href="package-System.Data.Common.Mssql.html">
						Mssql					</a>

						</li>
				<li>
					<a href="package-System.Data.Common.Mysql.html">
						Mysql					</a>

						</li>
				<li>
					<a href="package-System.Data.Common.Oracle.html">
						Oracle					</a>

						</li>
				<li>
					<a href="package-System.Data.Common.Pgsql.html">
						Pgsql					</a>

						</li>
				<li>
					<a href="package-System.Data.Common.Sqlite.html">
						Sqlite					</a>

						</li>
							</ul></li>
				<li>
					<a href="package-System.Data.DataGateway.html">
						DataGateway					</a>

						</li>
				<li>
					<a href="package-System.Data.SqlMap.html">
						SqlMap<span></span>
					</a>

						<ul>
				<li>
					<a href="package-System.Data.SqlMap.Configuration.html">
						Configuration					</a>

						</li>
				<li>
					<a href="package-System.Data.SqlMap.Statements.html">
						Statements					</a>

						</li>
							</ul></li></ul></li>
				<li>
					<a href="package-System.Exceptions.html">
						Exceptions					</a>

						</li>
				<li>
					<a href="package-System.I18N.html">
						I18N					</a>

						</li>
				<li>
					<a href="package-System.IO.html">
						IO					</a>

						</li>
				<li>
					<a href="package-System.Security.html">
						Security					</a>

						</li>
				<li>
					<a href="package-System.Util.html">
						Util					</a>

						</li>
				<li>
					<a href="package-System.Web.html">
						Web<span></span>
					</a>

						<ul>
				<li>
					<a href="package-System.Web.Javascripts.html">
						Javascripts					</a>

						</li>
				<li>
					<a href="package-System.Web.Services.html">
						Services					</a>

						</li>
				<li>
					<a href="package-System.Web.UI.html">
						UI<span></span>
					</a>

						<ul>
				<li>
					<a href="package-System.Web.UI.ActiveControls.html">
						ActiveControls					</a>

						</li>
				<li>
					<a href="package-System.Web.UI.JuiControls.html">
						JuiControls					</a>

						</li>
				<li>
					<a href="package-System.Web.UI.WebControls.html">
						WebControls					</a>

						</li>
							</ul></li></ul></li>
				<li>
					<a href="package-System.Wsat.html">
						Wsat					</a>

						</li>
				<li>
					<a href="package-System.Xml.html">
						Xml					</a>

						</li>
							</ul></li>
			</ul>
		</div>

		<hr>


		<div id="elements">
			<h3>Classes</h3>
			<ul>
				<li><a href="class-TDbCommandBuilder.html">TDbCommandBuilder</a></li>
				<li><a href="class-TDbMetaData.html">TDbMetaData</a></li>
				<li><a href="class-TDbTableColumn.html">TDbTableColumn</a></li>
				<li><a href="class-TDbTableInfo.html">TDbTableInfo</a></li>
				<li class="active"><a href="class-TMssqlCommandBuilder.html">TMssqlCommandBuilder</a></li>
				<li><a href="class-TMysqlCommandBuilder.html">TMysqlCommandBuilder</a></li>
				<li><a href="class-TOracleCommandBuilder.html">TOracleCommandBuilder</a></li>
				<li><a href="class-TOracleTableInfo.html">TOracleTableInfo</a></li>
				<li><a href="class-TPgsqlCommandBuilder.html">TPgsqlCommandBuilder</a></li>
				<li><a href="class-TSqliteCommandBuilder.html">TSqliteCommandBuilder</a></li>
			</ul>





		</div>
	</div>
</div>

<div id="splitter"></div>

<div id="right">
<div id="rightInner">
	<form id="search">
		<input type="hidden" name="cx" value="">
		<input type="hidden" name="ie" value="UTF-8">
		<input type="text" name="q" class="text" placeholder="Search">
	</form>

	<div id="navigation">
		<ul>
			<li>
				<a href="index.html" title="Overview"><span>Overview</span></a>
			</li>
			<li>
<span>Package</span>			</li>
			<li class="active">
<span>Class</span>			</li>
		</ul>
		<ul>
				<li>
					<a href="annotation-group-deprecated.html" title="List of elements with deprecated annotation">
						<span>Deprecated</span>
					</a>
				</li>
				<li>
					<a href="annotation-group-todo.html" title="List of elements with todo annotation">
						<span>Todo</span>
					</a>
				</li>
		</ul>
		<ul>
		</ul>
	</div>

<div id="content" class="class">
	<h1>Class TMssqlCommandBuilder</h1>


	<div class="description">
	<p>TMssqlCommandBuilder provides specifics methods to create limit/offset query commands
for MSSQL servers.</p>
	</div>

	<dl class="tree">
		<dd style="padding-left:0px">
			<a href="class-TComponent.html"><span>TComponent</span></a>
			
			
			
		</dd>
		<dd style="padding-left:30px">
			<img src="resources/inherit.png" alt="Extended by">
			<a href="class-TDbCommandBuilder.html"><span>TDbCommandBuilder</span></a>
			
			
			
		</dd>
		<dd style="padding-left:60px">
			<img src="resources/inherit.png" alt="Extended by">
<b><span>TMssqlCommandBuilder</span></b>			
			
			
		</dd>
	</dl>








	<div class="info">
		
		
		
		<b>Package:</b> <a href="package-System.html">System</a>\<a href="package-System.Data.html">Data</a>\<a href="package-System.Data.Common.html">Common</a><br>

				<b>Copyright:</b>
				Copyright &copy; 2005-2016 The PRADO Group<br>
				<b>License:</b>
				<a href="https://github.com/pradosoft/prado/blob/master/COPYRIGHT">https://github.com/pradosoft/prado/blob/master/COPYRIGHT</a><br>
				<b>Author:</b>
				Wei Zhuo &lt;weizho[at]gmail[dot]com><br>
				<b>Since:</b>
				3.1<br>
			<b>Located at</b> Data/Common/Mssql/TMssqlCommandBuilder.php		<br>
	</div>



	<table class="summary methods" id="methods">
	<caption>Methods summary</caption>
	<tr data-order="getLastInsertID" id="_getLastInsertID">

		<td class="attributes"><code>
			 public 

			integer
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_getLastInsertID">#</a>
		<code>getLastInsertID( )</code>

		<div class="description short">
			<p>Overrides parent implementation. Uses "SELECT @@Identity".</p>
		</div>

		<div class="description detailed hidden">
			<p>Overrides parent implementation. Uses "SELECT @@Identity".</p>



				<h4>Returns</h4>
				<div class="list">
					integer<br>last insert id, null if none is found.
				</div>



				<h4>Overrides</h4>
				<div class="list"><code><a href="class-TDbCommandBuilder.html#_getLastInsertID">TDbCommandBuilder::getLastInsertID()</a></code></div>

		</div>
		</div></td>
	</tr>
	<tr data-order="applyLimitOffset" id="_applyLimitOffset">

		<td class="attributes"><code>
			 public 

			string
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_applyLimitOffset">#</a>
		<code>applyLimitOffset( <span>string <var>$sql</var></span>, <span>integer <var>$limit</var> = -<span class="php-num">1</span></span>, <span>integer <var>$offset</var> = -<span class="php-num">1</span></span> )</code>

		<div class="description short">
			<p>Overrides parent implementation. Alters the sql to apply $limit and $offset.
The idea for limit with offset is done by modifying the sql on the fly
with numerous assumptions on the structure of the sql string.
The modification is done with reference to the notes from
http://troels.arvin.dk/db/rdbms/#select-limit-offset</p>
		</div>

		<div class="description detailed hidden">
			<p>Overrides parent implementation. Alters the sql to apply $limit and $offset.
The idea for limit with offset is done by modifying the sql on the fly
with numerous assumptions on the structure of the sql string.
The modification is done with reference to the notes from
http://troels.arvin.dk/db/rdbms/#select-limit-offset</p>

<pre>SELECT * FROM (
 SELECT TOP n * FROM (
   SELECT TOP z columns      -- (z=n+skip)
   FROM tablename
   ORDER BY <span class="php-keyword2">key</span> ASC
 ) <span class="php-keyword1">AS</span> FOO ORDER BY <span class="php-keyword2">key</span> DESC -- (<span class="php-quote">'FOO'</span> may be anything)
) <span class="php-keyword1">AS</span> BAR ORDER BY <span class="php-keyword2">key</span> ASC    -- (<span class="php-quote">'BAR'</span> may be anything)</pre>

<p><b>Regular expressions are used to alter the SQL query. The resulting SQL query
may be malformed for complex queries.</b> The following restrictions apply</p>

<ul> <li>
In particular, <b>commas</b> should <b>NOT</b>
be used as part of the ordering expression or identifier. Commas must only be
used for separating the ordering clauses. </li> <li>
In the ORDER BY clause, the column name should NOT be be qualified
with a table name or view name. Alias the column names or use column index.
</li>
<li>
No clauses should follow the ORDER BY clause, e.g. no COMPUTE or FOR clauses.
</li>
</ul>


				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$sql</var></dt>
					<dd>query string.</dd>
					<dt><var>$limit</var></dt>
					<dd>number of rows, -1 to ignore limit.</dd>
					<dt><var>$offset</var></dt>
					<dd>offset, -1 to ignore offset.</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					string<br>SQL with limit and offset.
				</div>



				<h4>Overrides</h4>
				<div class="list"><code><a href="class-TDbCommandBuilder.html#_applyLimitOffset">TDbCommandBuilder::applyLimitOffset()</a></code></div>

		</div>
		</div></td>
	</tr>
	<tr data-order="rewriteLimitOffsetSql" id="_rewriteLimitOffsetSql">

		<td class="attributes"><code>
			 protected 

			sql
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_rewriteLimitOffsetSql">#</a>
		<code>rewriteLimitOffsetSql( <span>string <var>$sql</var></span>, <span>integer <var>$limit</var></span>, <span>integer <var>$offset</var></span> )</code>

		<div class="description short">
			<p>Rewrite sql to apply $limit > and $offset > 0 for MSSQL database.
See http://troels.arvin.dk/db/rdbms/#select-limit-offset</p>
		</div>

		<div class="description detailed hidden">
			<p>Rewrite sql to apply $limit > and $offset > 0 for MSSQL database.
See http://troels.arvin.dk/db/rdbms/#select-limit-offset</p>


				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$sql</var></dt>
					<dd>query</dd>
					<dt><var>$limit</var></dt>
					<dd><blockquote>
  <p>0</p>
</blockquote></dd>
					<dt><var>$offset</var></dt>
					<dd><blockquote>
  <p>0</p>
</blockquote></dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					sql<br>modified sql query applied with limit and offset.
				</div>




		</div>
		</div></td>
	</tr>
	<tr data-order="findOrdering" id="_findOrdering">

		<td class="attributes"><code>
			 protected 

			array
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_findOrdering">#</a>
		<code>findOrdering( <span>string <var>$sql</var></span> )</code>

		<div class="description short">
			<p>Base on simplified syntax http://msdn2.microsoft.com/en-us/library/aa259187(SQL.80).aspx</p>
		</div>

		<div class="description detailed hidden">
			<p>Base on simplified syntax http://msdn2.microsoft.com/en-us/library/aa259187(SQL.80).aspx</p>


				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$sql</var></dt>
					<dd></dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					array<br>ordering expression as key and ordering direction as value
				</div>




		</div>
		</div></td>
	</tr>
	<tr data-order="joinOrdering" id="_joinOrdering">

		<td class="attributes"><code>
			 protected 

			string
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_joinOrdering">#</a>
		<code>joinOrdering( <span>array <var>$orders</var></span> )</code>

		<div class="description short">
			
		</div>

		<div class="description detailed hidden">
			


				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$orders</var></dt>
					<dd>obtained from findOrdering()</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					string<br>concat the orderings
				</div>




		</div>
		</div></td>
	</tr>
	<tr data-order="reverseDirection" id="_reverseDirection">

		<td class="attributes"><code>
			 protected 

			array
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_reverseDirection">#</a>
		<code>reverseDirection( <span>array <var>$orders</var></span> )</code>

		<div class="description short">
			
		</div>

		<div class="description detailed hidden">
			


				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$orders</var></dt>
					<dd>ordering</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					array<br>ordering with reversed direction.
				</div>




		</div>
		</div></td>
	</tr>
	</table>

	<table class="summary inherited">
	<caption>Methods inherited from <a href="class-TDbCommandBuilder.html#methods">TDbCommandBuilder</a></caption>
	<tr>
		<td><code>
			<a href="class-TDbCommandBuilder.html#___construct">__construct()</a>, 
			<a href="class-TDbCommandBuilder.html#_applyCriterias">applyCriterias()</a>, 
			<a href="class-TDbCommandBuilder.html#_applyOrdering">applyOrdering()</a>, 
			<a href="class-TDbCommandBuilder.html#_bindArrayValues">bindArrayValues()</a>, 
			<a href="class-TDbCommandBuilder.html#_bindColumnValues">bindColumnValues()</a>, 
			<a href="class-TDbCommandBuilder.html#_createCommand">createCommand()</a>, 
			<a href="class-TDbCommandBuilder.html#_createCountCommand">createCountCommand()</a>, 
			<a href="class-TDbCommandBuilder.html#_createDeleteCommand">createDeleteCommand()</a>, 
			<a href="class-TDbCommandBuilder.html#_createFindCommand">createFindCommand()</a>, 
			<a href="class-TDbCommandBuilder.html#_createInsertCommand">createInsertCommand()</a>, 
			<a href="class-TDbCommandBuilder.html#_createUpdateCommand">createUpdateCommand()</a>, 
			<a href="class-TDbCommandBuilder.html#_getColumnBindings">getColumnBindings()</a>, 
			<a href="class-TDbCommandBuilder.html#_getDbConnection">getDbConnection()</a>, 
			<a href="class-TDbCommandBuilder.html#_getInsertFieldBindings">getInsertFieldBindings()</a>, 
			<a href="class-TDbCommandBuilder.html#_getPdoType">getPdoType()</a>, 
			<a href="class-TDbCommandBuilder.html#_getSearchCondition">getSearchCondition()</a>, 
			<a href="class-TDbCommandBuilder.html#_getSearchExpression">getSearchExpression()</a>, 
			<a href="class-TDbCommandBuilder.html#_getSelectFieldList">getSelectFieldList()</a>, 
			<a href="class-TDbCommandBuilder.html#_getTableInfo">getTableInfo()</a>, 
			<a href="class-TDbCommandBuilder.html#_hasIntegerKey">hasIntegerKey()</a>, 
			<a href="class-TDbCommandBuilder.html#_setDbConnection">setDbConnection()</a>, 
			<a href="class-TDbCommandBuilder.html#_setTableInfo">setTableInfo()</a>
		</code></td>
	</tr>
	</table>
	<table class="summary inherited">
	<caption>Methods inherited from <a href="class-TComponent.html#methods">TComponent</a></caption>
	<tr>
		<td><code>
			<a href="class-TComponent.html#___call">__call()</a>, 
			<a href="class-TComponent.html#___destruct">__destruct()</a>, 
			<a href="class-TComponent.html#___get">__get()</a>, 
			<a href="class-TComponent.html#___isset">__isset()</a>, 
			<a href="class-TComponent.html#___set">__set()</a>, 
			<a href="class-TComponent.html#___sleep">__sleep()</a>, 
			<a href="class-TComponent.html#___unset">__unset()</a>, 
			<a href="class-TComponent.html#__getZappableSleepProps">_getZappableSleepProps()</a>, 
			<a href="class-TComponent.html#_addParsedObject">addParsedObject()</a>, 
			<a href="class-TComponent.html#_asa">asa()</a>, 
			<a href="class-TComponent.html#_attachBehavior">attachBehavior()</a>, 
			<a href="class-TComponent.html#_attachBehaviors">attachBehaviors()</a>, 
			<a href="class-TComponent.html#_attachClassBehavior">attachClassBehavior()</a>, 
			<a href="class-TComponent.html#_attachEventHandler">attachEventHandler()</a>, 
			<a href="class-TComponent.html#_canGetProperty">canGetProperty()</a>, 
			<a href="class-TComponent.html#_canSetProperty">canSetProperty()</a>, 
			<a href="class-TComponent.html#_clearBehaviors">clearBehaviors()</a>, 
			<a href="class-TComponent.html#_createdOnTemplate">createdOnTemplate()</a>, 
			<a href="class-TComponent.html#_detachBehavior">detachBehavior()</a>, 
			<a href="class-TComponent.html#_detachBehaviors">detachBehaviors()</a>, 
			<a href="class-TComponent.html#_detachClassBehavior">detachClassBehavior()</a>, 
			<a href="class-TComponent.html#_detachEventHandler">detachEventHandler()</a>, 
			<a href="class-TComponent.html#_disableBehavior">disableBehavior()</a>, 
			<a href="class-TComponent.html#_disableBehaviors">disableBehaviors()</a>, 
			<a href="class-TComponent.html#_enableBehavior">enableBehavior()</a>, 
			<a href="class-TComponent.html#_enableBehaviors">enableBehaviors()</a>, 
			<a href="class-TComponent.html#_evaluateExpression">evaluateExpression()</a>, 
			<a href="class-TComponent.html#_evaluateStatements">evaluateStatements()</a>, 
			<a href="class-TComponent.html#_fxAttachClassBehavior">fxAttachClassBehavior()</a>, 
			<a href="class-TComponent.html#_fxDetachClassBehavior">fxDetachClassBehavior()</a>, 
			<a href="class-TComponent.html#_getAutoGlobalListen">getAutoGlobalListen()</a>, 
			<a href="class-TComponent.html#_getBehaviorsEnabled">getBehaviorsEnabled()</a>, 
			<a href="class-TComponent.html#_getClassHierarchy">getClassHierarchy()</a>, 
			<a href="class-TComponent.html#_getEventHandlers">getEventHandlers()</a>, 
			<a href="class-TComponent.html#_getListeningToGlobalEvents">getListeningToGlobalEvents()</a>, 
			<a href="class-TComponent.html#_getSubProperty">getSubProperty()</a>, 
			<a href="class-TComponent.html#_hasEvent">hasEvent()</a>, 
			<a href="class-TComponent.html#_hasEventHandler">hasEventHandler()</a>, 
			<a href="class-TComponent.html#_hasProperty">hasProperty()</a>, 
			<a href="class-TComponent.html#_isa">isa()</a>, 
			<a href="class-TComponent.html#_listen">listen()</a>, 
			<a href="class-TComponent.html#_raiseEvent">raiseEvent()</a>, 
			<a href="class-TComponent.html#_setSubProperty">setSubProperty()</a>, 
			<a href="class-TComponent.html#_unlisten">unlisten()</a>
		</code></td>
	</tr>
	</table>








	<table class="summary inherited">
	<caption>Constants inherited from <a href="class-TComponent.html#constants">TComponent</a></caption>
	<tr>
		<td><code>
			<a href="class-TComponent.html#GLOBAL_RAISE_EVENT_LISTENER"><b>GLOBAL_RAISE_EVENT_LISTENER</b></a>
		</code></td>
	</tr>
	</table>









</div>

	<div id="footer">
		PRADO v3.3.1 API Manual API documentation generated by <a href="http://apigen.org">ApiGen</a>
	</div>
</div>
</div>

<script src="resources/combined.js"></script>
<script src="elementlist.js"></script>
</body>
</html>
